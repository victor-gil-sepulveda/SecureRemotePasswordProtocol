/*
 * TestSha1.cpp
 *
 *  Created on: Dec 2, 2016
 *      Author: victor
 */

#include <iostream>
#include <string>

#include "../../SRP/src/sha/Sha1.h"
#include "../../SRP/src/sha/Utils.h"
using namespace std;

#include <boost/test/unit_test.hpp>

BOOST_AUTO_TEST_SUITE(Sha1Test)

BOOST_AUTO_TEST_CASE(message_preprocessing)
{
	string initial_message = "Hola!";
	string expected = "0x48 0x6f 0x6c 0x61 0x21 0x80 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x28";
	string result = algorithms::Sha1::preprocess_message(initial_message);

	BOOST_CHECK_EQUAL(algorithms::utils::to_hex_str(result), expected);
}



BOOST_AUTO_TEST_SUITE_END()
